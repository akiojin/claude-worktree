# 実装計画: Clean up merged PRs 機能修正

**ブランチ**: `hotfix/fix-cleanup` | **日付**: 2025-01-06 | **仕様**: [spec.md](./spec.md)
**入力**: `/specs/002-clearn-up-marged/spec.md` の機能仕様

## 実行フロー（/plan コマンドの範囲）
```
1. 入力パスから機能仕様を読み込む
   → 完了: メインメニューでの表示不整合を確認
2. 技術コンテキストを埋める
   → TypeScript/Node.js環境で実装
   → inquirer/coreを使用したCLI
3. 憲章チェックを評価
   → シンプルさ: 最小限の変更で修正可能
   → 複雑性なし: 表示文字列の修正のみ
4. フェーズ0を実行 → research.md
   → 完了: 問題の原因を特定（未実装機能への参照）
5. フェーズ1を実行 → contracts、data-model.md、quickstart.md
   → 完了: 設計ドキュメント作成
6. 憲章チェックを再評価
   → 新たな違反なし
7. フェーズ2の計画 → タスク生成アプローチを記述
8. STOP - /tasks コマンドの準備完了
```

## 要約
メインメニューに表示される「(a) Account management」への言及を削除し、実装されていない機能への参照を排除することで、ユーザーエクスペリエンスを改善します。

## 技術コンテキスト
**言語/バージョン**: TypeScript 5.x / Node.js 18+  
**主要依存**: inquirer/core, chalk, commander  
**ストレージ**: N/A（表示のみの修正）  
**テスト**: Jest / Vitest  
**ターゲットプラットフォーム**: Linux/macOS/Windows CLI  
**プロジェクト種別**: single（CLIツール）  
**性能目標**: 即座の応答（<100ms）  
**制約**: 既存機能への影響を最小限に  
**規模/範囲**: 1ファイル、1行の修正

## 憲章チェック
*GATE: フェーズ0の調査前に合格必須。フェーズ1設計後に再チェック。*

**シンプルさ**:
- プロジェクト数: 1（CLIツールのみ）
- フレームワークを直接使用？ Yes（inquirer/core）
- 単一データモデル？ Yes（MenuDisplay）
- パターン濫用を回避？ Yes（単純な文字列修正）

**アーキテクチャ**:
- すべての機能はライブラリ化？ N/A（バグ修正）
- ライブラリ一覧: N/A
- ライブラリごとにCLI提供: N/A
- ライブラリドキュメント: N/A

**テスト（非交渉）**:
- RED→GREEN→リファクタのサイクル強制？ Yes
- Git の履歴に実装前のテストが残る？ Yes
- 順序: Contract→Integration→E2E→Unit を厳守？ Yes
- 実物依存を使用？ Yes
- 統合テスト: メニュー表示のテスト
- 禁止事項: なし

**可観測性**:
- 構造化ログを含む？ 既存実装を維持
- フロントのログ→バックエンド集約？ N/A
- エラー文脈は十分？ Yes

**バージョニング**:
- バージョン番号付与？ パッチバージョンアップ
- 変更ごとに BUILD を増分？ Yes
- 破壊的変更の扱い？ なし（後方互換性維持）

## プロジェクト構成

### ドキュメント（本機能）
```
specs/002-clearn-up-marged/
├── spec.md              # 機能仕様
├── plan.md              # 本ファイル（実装計画）
├── research.md          # フェーズ0の出力（調査結果）
├── data-model.md        # フェーズ1の出力（データモデル）
├── quickstart.md        # フェーズ1の出力（クイックスタート）
├── contracts/           # フェーズ1の出力（API契約）
│   └── menu-display.json
└── tasks.md             # フェーズ2の出力（/tasks コマンドで生成）
```

### ソースコード（リポジトリルート）
```
src/
├── ui/
│   └── prompts.ts       # 修正対象ファイル
├── index.ts             # メインループ（変更なし）
└── ...                  # その他のファイル（変更なし）

tests/
├── unit/
│   └── prompts.test.ts  # 単体テスト
└── integration/
    └── menu.test.ts     # 統合テスト
```

**構成方針**: 単一プロジェクト構成を維持

## フェーズ0: 叩き台 & 調査
✅ 完了

**調査結果**:
- 決定: メニュー表示文字列から「(a) Account management」を削除
- 根拠: 'a'キーハンドラーが未実装であり、ユーザーの混乱を招く
- 代替案: Account management機能の実装（却下：仕様が不明確）

**出力**: research.md作成済み

## フェーズ1: 設計 & 契約
✅ 完了

1. **data-model.md**: MenuDisplay、MenuAction、Choiceエンティティを定義
2. **contracts/menu-display.json**: メニュー表示のOpenAPI仕様
3. **quickstart.md**: 修正確認手順とテストシナリオ

**出力**: 設計ドキュメント作成済み

## フェーズ2: タスク計画アプローチ
*この節は /tasks コマンドが実施する内容の説明です*

**タスク生成戦略**:
1. メニュー表示のテストケース作成
2. prompts.tsの修正（199行目）
3. 統合テストの実行
4. リグレッションテスト

**順序戦略**:
- TDD順: テスト作成 → 実装修正 → テスト確認
- 依存順: 単体修正のため依存関係なし

**想定出力**: 4-5個のタスク

## 複雑性トラッキング
*憲章チェックの違反なし*

## 進捗トラッキング

**フェーズ状況**:
- [x] フェーズ0: 調査完了（/plan）
- [x] フェーズ1: 設計完了（/plan）
- [x] フェーズ2: タスク計画完了（/plan - アプローチ記述のみ）
- [ ] フェーズ3: タスク生成（/tasks）
- [ ] フェーズ4: 実装完了
- [ ] フェーズ5: 検証合格

**ゲート状況**:
- [x] 初回の憲章チェック: PASS
- [x] 設計後の憲章チェック: PASS
- [x] すべての NEEDS CLARIFICATION を解消
- [x] 複雑性の逸脱を記録（なし）

---
*Constitution v2.1.1 に基づく — `/memory/constitution.md` を参照*