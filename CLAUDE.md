# CLAUDE.md

このファイルは、Claude Code (claude.ai/code) がこのリポジトリでコードを扱う際のガイダンスを提供します。

## 開発指針

### 🎯 プロジェクトの価値を実現

**最重要**: `claude-worktree`はGit worktree管理を効率化するインタラクティブCLIツールです：

1. **インタラクティブな操作**: カーソルベースでの直感的なブランチ選択
2. **自動化されたワークフロー**: worktreeの作成・管理・クリーンアップを自動化
3. **Claude Code統合**: Claude Code開発ワークフローに最適化
4. **ユニバーサル対応**: NPMパッケージとして任意のプロジェクトで利用可能

### 🛠️ 技術実装指針

- **設計・実装は複雑にせずに、シンプルさの極限を追求してください**
- **ただし、ユーザビリティと開発者体験の品質は決して妥協しない**
- 実装はシンプルに、開発者体験は最高品質に
- CLI操作の直感性と効率性を技術的複雑さより優先
- Git worktree管理の効率性と安全性のバランスを重視

### 📝 設計ガイドライン

- 設計に関するドキュメントには、ソースコードを書かないこと

## 開発品質

### 完了条件

- エラーが発生している状態で完了としないこと。必ずエラーが解消された時点で完了とする。

## プロジェクト情報

### ビルドコマンド

```bash
npm run build    # TypeScriptコンパイル
npm run dev      # ウォッチモードでのコンパイル
npm start        # ビルド済みバイナリの実行
```

### テストコマンド

```bash
npm run type-check  # TypeScript型チェック
npm run lint        # ESLint実行
```

### 主要な依存関係

- **TypeScript 5.7.2**: 型安全な開発
- **Node.js CLI**: インタラクティブCLIツール
- **@inquirer/prompts**: ユーザー入力処理
- **chalk**: コンソール出力の色付け
- **execa**: Git コマンドの実行

### アーキテクチャ

- **言語**: TypeScript
- **実行環境**: Node.js >= 18.0.0
- **パッケージ管理**: NPM (グローバルインストール対応)
- **Git統合**: Git worktree コマンドとの連携

## 開発ワークフロー

### 基本ルール

- 作業（タスク）を完了したら、変更点をコミットログに追加して、コミット＆プッシュを必ず行う
- 作業（タスク）は、最大限の並列化をして進める
- 作業（タスク）は、最大限の細分化をしてToDoに登録する
- Spec Kitを利用したSDD/TDDの徹底運用を行う
- 作業（タスク）の開始前には、必ずTodoWriteでToDoを登録した後に作業を開始する
- 作業（タスク）の完了後は、作業内容をプッシュして、必ずPRを出す。
- 作業（タスク）を出す前には、必ずmainの最新版をマージする。
- 作業（タスク）は、忖度なしで進める
- 作業（タスク）のPRはmainブランチに対して行う

## GitHub Issues更新ルール

**全てのタスクにおいて、以下のGitHub Issues更新ルールに従ってIssueを更新すること**

### タスク開始時の必須アクション

1. **Assignee設定**
   - 作業開始時に自分をAssigneeに設定
   - 複数人で作業する場合は全メンバーをAssigneeに追加

2. **ラベル更新**
   - `in-progress` ラベルを追加
   - 該当する種別ラベル（`cli`, `git`, `typescript`, `docs`等）を追加

3. **開始コメント記録**

   ```markdown
   ## 🚀 作業開始

   **開始日時**: 2025-07-13 10:00  
   **担当者**: @username  
   **予定完了日**: 2025-07-14  

   ### 作業計画
   - [ ] タスク1の詳細
   - [ ] タスク2の詳細
   - [ ] テスト・検証

   ### 関連Issue/PR
   - 関連Issue: #123
   - 依存Issue: #456
   ```

### 作業中の進捗更新

1. **定期的な進捗報告（最低1日1回）**

   ```markdown
   ## 📈 進捗報告 (2025-07-13)

   ### 完了した作業
   - ✅ CLI インターフェース実装完了
   - ✅ 基本的なテストケース追加

   ### 現在の作業
   - 🔄 Git worktree統合作業中

   ### 次の予定
   - 📋 エラーハンドリングの実装
   - 📋 E2Eテストの実行

   ### 課題・ブロッカー
   - ⚠️ Git worktree コマンドの動作について要確認 → @reviewer
   ```

2. **問題発生時の即座報告**

   ```markdown
   ## ⚠️ 問題報告

   **発生日時**: 2025-07-13 15:30  
   **問題内容**: TypeScript型エラーが解決できない  
   **影響範囲**: CLI実装全体  
   **対応方針**: 設計見直しが必要かもしれません  

   **詳細**:
   ```typescript
   // エラーの詳細コードを記載
   ```

   **支援要請**: @senior-developer のレビューをお願いします
   ```

### タスク完了時の必須アクション

1. **完了報告**

   ```markdown
   ## ✅ タスク完了報告

   **完了日時**: 2025-07-14 16:00  
   **最終担当者**: @username  

   ### 実装内容
   - ✅ CLI コマンド実装
   - ✅ Git worktree統合機能追加
   - ✅ エラーハンドリング強化

   ### テスト結果
   - ✅ 型チェック: エラーなし
   - ✅ Lint: 問題なし
   - ✅ 手動テスト: 正常動作確認

   ### 関連PR
   - PR #123: CLI機能実装

   ### 注意事項・引き継ぎ
   - Git worktreeパスは自動生成される
   - 今後の拡張時は `GitWorktreeManager` クラスを変更
   ```

2. **品質チェック完了の確認**
   - [ ] npm run type-check 通過
   - [ ] npm run lint 通過  
   - [ ] 関連テスト全て通過
   - [ ] 手動動作確認完了

3. **Issue クローズ**
   - 上記完了報告後、Issue を Close
   - 関連するPRがある場合はリンクを確認

### ラベル使用ルール

#### 進捗状態ラベル

- `needs-triage`: 新規Issue、内容整理が必要
- `ready`: 作業開始可能
- `in-progress`: 作業中
- `needs-review`: レビュー待ち
- `blocked`: 他の作業待ち・問題発生
- `completed`: 完了（クローズ前の最終確認）

#### 優先度ラベル

- `priority:critical`: 緊急対応必要
- `priority:high`: 高優先度
- `priority:medium`: 通常優先度
- `priority:low`: 低優先度

#### 種別ラベル

- `type:feature`: 新機能開発
- `type:bug`: バグ修正
- `type:enhancement`: 機能改善
- `type:docs`: ドキュメント
- `type:refactor`: リファクタリング

#### 技術領域ラベル

- `cli`: CLI機能
- `git`: Git統合
- `typescript`: TypeScript実装
- `npm`: NPMパッケージ
- `ui`: ユーザーインターフェース
- `performance`: パフォーマンス

### エスカレーションルール

#### 即座にエスカレーションが必要な場合

1. **クリティカルなバグ発見**
   - Git操作に影響する可能性がある場合
   - データ損失のリスクがある場合

2. **ブロッカーが解決できない**
   - 1日以上作業が停止している場合
   - Git worktree仕様の理解が必要な場合

3. **仕様変更が必要**
   - 既存設計との矛盾を発見した場合
   - パフォーマンス要件を満たせない場合

#### エスカレーション方法

```markdown
## 🚨 エスカレーション

**レベル**: Critical/High/Medium  
**理由**: 具体的な理由  
**影響範囲**: プロジェクト全体/特定機能  
**対応期限**: 2025-07-14  

**詳細**:
問題の詳細な説明

**提案**: 
可能な解決策があれば記載

**メンション**: @project-manager @team-lead
```

## コミュニケーションガイドライン

- 回答は必ず日本語

## 外部連携

### GitHub操作について
- **重要**: GitHub MCPは使用禁止です
- GitHub操作は**GitHub CLI (`gh`)コマンド**を直接Bashツールで実行してください
- 例: `gh pr create`, `gh issue create`, `gh repo config apply`など

### 利用可能なMCPツール
- `context7` MCP を使用して、最新のNode.js、TypeScript、およびその他のライブラリを確認してください。
- `google-search`MCPウェブ検索を使用して、最新の解決策を検索できます。
- `model-hub`MCPを使用して、最新のモデルを取得することができます。

## ドキュメント管理

- ドキュメントはルートディレクトリに配置してはいけない。必ずdocs/配下に配置する

## コードクオリティガイドライン

- マークダウンファイルはmarkdownlintでエラー及び警告がない状態にする
- コミットログはcommitlintに対応する

## 開発ガイドライン

- Spec Kitを用いたSDD/TDDの絶対遵守を義務付ける。違反が確認されたタスクは即座に差し戻す。Spec KitでSDD承認を得てSpec準拠のTDDサイクルを完了する前の実装着手を全面禁止する。
- 既存のファイルのメンテナンスを無視して、新規ファイルばかり作成するのは禁止。既存ファイルを改修することを優先する。

## ドキュメント作成ガイドライン

- README.mdには設計などは書いてはいけない。プロジェクトの説明やディレクトリ構成などの説明のみに徹底する。設計などは、適切なファイルへのリンクを書く。

## インフラストラクチャガイドライン

- GitHub Actionsで使用するホストランナーはself-hosted/macOSのみ許可
- self-hostedランナーは組織に登録されているため、常にself-hostedを使用する

## ブランチ管理

- ブランチ保護ルールの更新は.github/config/以下のファイルを更新して、`gh repo config apply`で行う。
- ブランチ保護ルールは`gh repo config apply`で行う。

## CLI開発メモリ

- インタラクティブCLI操作の品質が最重要
- Git worktree操作の安全性を常に確保すること
